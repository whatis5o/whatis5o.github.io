<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - AfriStay</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Oleo+Script+Swash+Caps:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/Style/style.css">
    <style>
        :root { --primary: #EB6753; }
        body { background: #f5f5f5; }
        .page-body { max-width: 900px; margin: 0 auto; padding: 110px 24px 72px; }

        .checkout-grid { display: grid; grid-template-columns: 1fr 340px; gap: 28px; align-items: start; }

        /* Summary card */
        .summary-card, .payment-card {
            background: #fff; border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0,0,0,0.08); padding: 28px;
        }
        .payment-card { position: sticky; top: 100px; }

        .card-title { font-size: 18px; font-weight: 700; color: #1a1a1a; margin: 0 0 20px; padding-bottom: 14px; border-bottom: 2px solid #f5f5f5; }

        /* Listing row */
        .listing-row { display: flex; gap: 16px; align-items: center; margin-bottom: 24px; }
        .listing-thumb { width: 80px; height: 60px; border-radius: 10px; object-fit: cover; background: #eee; flex-shrink: 0; }
        .listing-info h3 { font-size: 16px; font-weight: 700; color: #1a1a1a; margin: 0 0 4px; }
        .listing-info p { font-size: 13px; color: #888; margin: 0; }

        /* Date row */
        .date-row { display: flex; gap: 12px; margin-bottom: 20px; }
        .date-box { flex: 1; background: #f9f9f9; border-radius: 12px; padding: 14px; }
        .date-box .label { font-size: 11px; text-transform: uppercase; font-weight: 700; color: #aaa; letter-spacing: 0.6px; margin-bottom: 4px; }
        .date-box .value { font-size: 15px; font-weight: 600; color: #222; }

        /* Price breakdown */
        .price-row { display: flex; justify-content: space-between; align-items: center; font-size: 14px; color: #555; margin-bottom: 12px; }
        .price-row.total { border-top: 2px solid #f0f0f0; padding-top: 14px; margin-top: 4px; font-size: 18px; font-weight: 700; color: #1a1a1a; }
        .price-row.total .amount { color: var(--primary); }

        /* Payment method */
        .method-title { font-size: 13px; font-weight: 700; color: #666; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 12px; }
        .method-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .method-btn { border: 2px solid #eee; border-radius: 12px; padding: 14px 10px; text-align: center; cursor: pointer; transition: all 0.2s; background: #fff; }
        .method-btn:hover, .method-btn.selected { border-color: var(--primary); background: #fff5f4; }
        .method-btn i { font-size: 22px; display: block; margin-bottom: 6px; color: #555; }
        .method-btn.selected i { color: var(--primary); }
        .method-btn span { font-size: 12px; font-weight: 600; color: #444; }

        /* Confirm button */
        .confirm-btn { width: 100%; padding: 16px; background: var(--primary); color: #fff; border: none;
            border-radius: 14px; font-size: 16px; font-weight: 700; cursor: pointer; display: flex;
            align-items: center; justify-content: center; gap: 10px; transition: all 0.3s; }
        .confirm-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(235,103,83,0.4); }
        .confirm-btn:disabled { opacity: 0.45; cursor: not-allowed; }

        .status-msg { font-size: 13px; text-align: center; margin-top: 12px; font-weight: 500; min-height: 20px; }

        .back-link { display: inline-flex; align-items: center; gap: 6px; color: var(--primary); text-decoration: none;
            font-size: 14px; font-weight: 600; margin-bottom: 20px; }
        .back-link:hover { opacity: 0.8; }

        .secure-note { text-align: center; font-size: 12px; color: #aaa; margin-top: 14px; }
        .secure-note i { color: #2ecc71; }

        @media (max-width: 768px) { .checkout-grid { grid-template-columns: 1fr; } .payment-card { position: static; } }
        @media (max-width: 500px) { .date-row { flex-direction: column; } .method-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

        <nav id="navbar">
            <div class="logo-area">
                <a href="/"><img src="/Pictures/light-afri1.png" alt="AfriStay" class="full-logo"></a>
            </div>
    
            <div class="nav-wrapper" id="navWrapper">
                <i class="fa-solid fa-xmark menu-close" onclick="toggleMenu()"></i>
                <div class="nav-center">
                    <ul class="nav-links">
                        <li><a href="/" class = "active">Home</a></li>
                        <li><a href="/Listings">Listings</a></li>
                        <li><a href="/Events/">Events</a></li>
                        <li><a href="/About">About</a></li>
                        <li><a href="/Contact">Contact</a></li>
                    </ul>
                </div>
                <div class="nav-right">
                    <a href="/Favorites" class="icon-link"><i class="fa-regular fa-heart"></i></a>
                    <a href="/Auth" id="auth-btn" class="signin-btn">Sign In</a> 
                </div>
            </div>
            <i class="fa-solid fa-bars menu-open" onclick="toggleMenu()"></i>
        </nav>

<div class="page-body">
    <a href="javascript:history.back()" class="back-link">
        <i class="fa-solid fa-arrow-left"></i> Back to Listing
    </a>

    <div class="checkout-grid">

        <!-- LEFT: Booking Summary -->
        <div class="summary-card">
            <h2 class="card-title"><i class="fa-solid fa-receipt" style="color:#EB6753;margin-right:8px;"></i>Booking Summary</h2>

            <div class="listing-row">
                <img id="listingThumb" class="listing-thumb" src="" alt=""
                     onerror="this.style.display='none'">
                <div class="listing-info">
                    <h3 id="listingTitle">Loading...</h3>
                    <p id="listingId" style="font-size:11px;color:#ccc;"></p>
                </div>
            </div>

            <div class="date-row">
                <div class="date-box">
                    <div class="label"><i class="fa-solid fa-plane-arrival"></i> Check-in</div>
                    <div class="value" id="checkInDate">â€”</div>
                </div>
                <div style="display:flex;align-items:center;color:#ccc;font-size:20px;padding-top:14px;">â†’</div>
                <div class="date-box">
                    <div class="label"><i class="fa-solid fa-plane-departure"></i> Check-out</div>
                    <div class="value" id="checkOutDate">â€”</div>
                </div>
            </div>

            <div class="price-row">
                <span id="nightsLabel">â€” nights</span>
                <span id="nightsAmount">â€”</span>
            </div>
            <div class="price-row">
                <span>Service fee</span>
                <span style="color:#2ecc71;">Free</span>
            </div>
            <div class="price-row total">
                <span>Total</span>
                <span class="amount" id="totalAmount">â€”</span>
            </div>
        </div>

        <!-- RIGHT: Payment Card -->
        <div class="payment-card">
            <h2 class="card-title"><i class="fa-solid fa-credit-card" style="color:#EB6753;margin-right:8px;"></i>Pay & Confirm</h2>

            <div class="method-title">Payment Method</div>
            <div class="method-grid">
                <div class="method-btn selected" data-method="mobile_money" onclick="selectMethod(this, 'mobile_money')">
                    <i class="fa-solid fa-mobile-screen-button"></i>
                    <span>Mobile Money</span>
                </div>
                <div class="method-btn" data-method="card" onclick="selectMethod(this, 'card')">
                    <i class="fa-solid fa-credit-card"></i>
                    <span>Card</span>
                </div>
                <div class="method-btn" data-method="bank_transfer" onclick="selectMethod(this, 'bank_transfer')">
                    <i class="fa-solid fa-building-columns"></i>
                    <span>Bank Transfer</span>
                </div>
                <div class="method-btn" data-method="cash" onclick="selectMethod(this, 'cash')">
                    <i class="fa-solid fa-money-bill-wave"></i>
                    <span>Cash on Arrival</span>
                </div>
            </div>

            <div id="methodNote" style="background:#f9f9f9;border-radius:10px;padding:12px;font-size:13px;color:#666;margin-bottom:18px;line-height:1.5;">
                ðŸ“± You'll receive a Mobile Money prompt after confirming.
            </div>

            <button class="confirm-btn" id="confirmBtn" onclick="confirmBooking()">
                <i class="fa-solid fa-lock"></i> Confirm Booking
            </button>
            <div class="status-msg" id="statusMsg"></div>
            <div class="secure-note"><i class="fa-solid fa-shield-halved"></i> Secure & encrypted checkout</div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="/js/config.js"></script>
<script src="/js/checkout.js"></script>
</body>
</html>
